# Summary 
This repository contain code to perform network repair of directed graph based in-balanced coloring condition. Given a directed graph and color labels for graph find minimal number of edges to add/remove to satisfy in-balance condition. The problem is formalized as a Mixed-Integer Programming (MIP) problem and solved using Gurobi.  

# Repository content 

- repair.py 
    Main script that takes in graph file, node color files and parameter file and uses repair_direct_ar_prohibit_Binary_Options.py to solve MIP. 

- repair_direct_ar_prohibit_Binary_Options.py  
    This script provides a solution to the problem of finding the minimum number of edges to add or remove in a directed network to ensure the coloring is imbalanced. It uses Gurobi for optimization and NetworkX for graph manipulation. Called by repair.py

- disparity.ipynb - code for calculating color disparity  

- graphs.py

# Key features
Graph repair: min number of edges are added/removed such that in-balance coloring condition is satisfied. 
MIP optimization is set up given:
    - variables:
        - remove_edge/add_edge: binary
    - constraints:
        - balance_type: changes the balancing from hard to soft constraints. 
        - InDegOneFlag: Ensure node in-degrees meet specific criteria.
    - objective function:
        minimize the number of edge operations (additions/removals).


# How to use
The main usage is to run the repair file from the command line. Run:
python repair.py -h

for the options. One sample run would be:
python repair.py -i "graph.graph.txt" -p "param.yaml" -c "colors.colors.txt" -o "output_o_"

# Citation

> @article{Leifer_2022,
>    abstract = {Symmetries found through automorphisms or graph fibrations provide important insights in network analysis. Symmetries identify clusters of robust synchronization in the network which improves the understanding of the functionality of complex biological systems. Network symmetries can be determined by finding a balanced coloring of the graph, which is a node partition in which each cluster of nodes receives the same information (color) from the rest of the graph. In recent work we saw that biological networks such as gene regulatory networks, metabolic networks and neural networks in organisms ranging from bacteria to yeast and humans are rich in fibration symmetries related to the graph balanced coloring. Networks based on real systems, however, are built on experimental data which are inherently incomplete, due to missing links, collection errors, and natural variations within specimens of the same biological species. Therefore, it is fair to assume that some of the existing symmetries were not detected in our analysis. For that reason, a method to find pseudosymmetries and repair networks based on those symmetries is important when analyzing real world networks. In this paper we introduce the pseudobalanced coloring (PBCIP) problem, and provide an integer programming formulation which (a) calculates a PBCIP of the graph taking into account the missing data, and (b) optimally repairs the graph with the minimal number of added/removed edges to maximize the symmetry of the graph. We apply our formulation to the C. elegans connectome to find pseudocoloring and the optimal graph repair. Our solution compares well with a manually curated ground-truth C. elegans graph as well as solutions generated by other methods of missing link prediction. Furthermore, we provide an extension of the algorithm using Bender's decomposition that allows our formulation to be applied to larger networks.},
>    author = {Leifer, Ian and Phillips, David and Sorrentino, Francesco and Makse, Hern{\'a}n A},
>    doi = {10.1088/1742-5468/ac7a26},
>    journal = {Journal of Statistical Mechanics: Theory and Experiment},
>    month = {jul},
>    number = {7},
>    pages = {073403},
>    publisher = {IOP Publishing and SISSA},
>    title = {Symmetry-driven network reconstruction through pseudobalanced coloring optimization},
>    url = {https://dx.doi.org/10.1088/1742-5468/ac7a26},
>    volume = {2022},
>    year = {2022},
>    Bdsk-Url-1 = {https://dx.doi.org/10.1088/1742-5468/ac7a26}}
